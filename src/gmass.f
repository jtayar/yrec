
C******************************************************************8
      REAL*8 FUNCTION GMASS(X,Z,AMOLES,EGROUND,FRACZ,FRAC)
      IMPLICIT REAL*8 (A-H,O-Z)
      DIMENSION ANUM(6),FRAC(7), AMAS(7),EION(7)
      DATA (EION(I),I=1,6)/-3388.637D0,-1970.918D0,-1431.717D0,
     X -993.2303D0,-76.2315D0,-15.29409D0/
      DATA (ANUM(I),I=1,6)/10.D0,8.D0,7.D0,6.D0,2.D0,1.D0/
      SAVE
      XC=0.247137766D0
      XN=.0620782D0
      XO=.52837118D0
      XNE=.1624188D0
      AMAS(7)=1.0079D0
      AMAS(6)=4.0026D0
      AMAS(5)=12.011D0
      AMAS(4)=14.0067D0
      AMAS(3)=15.9994D0
      AMAS(2)=20.179D0
      AMAS(1)=0.00054858D0
      FRACZ=Z/(XC*AMAS(5)+XN*AMAS(4)+XO*AMAS(3)+XNE*AMAS(2))
      XC2=FRACZ*XC
      XN2=FRACZ*XN
      XO2=FRACZ*XO
      XNE2=FRACZ*XNE
      XH=X/AMAS(7)
      XHE=(1.D0-X -Z)/AMAS(6)
      XTOT=XH+XHE+XC2+XN2+XO2+XNE2
      FRAC(6)=XH/XTOT
      FRAC(5)=XHE/XTOT
      FRAC(4)=XC2/XTOT
      FRAC(3)=XN2/XTOT
      FRAC(2)=XO2/XTOT
      FRAC(1)=XNE2/XTOT
      EGROUND=0.0D0
      AMOLES=0.0D0
      DO I=1,6
      EGROUND=EGROUND+EION(I)*FRAC(I)
      AMOLES=AMOLES+(1.D0+ANUM(I))*FRAC(I)
      ENDDO
      ANUME=AMOLES-1.D0
      GMASS=ANUME*AMAS(1)
      DO I=2,7
      GMASS=GMASS+AMAS(I)*FRAC(I-1)
      ENDDO

      RETURN
      END
